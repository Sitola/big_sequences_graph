<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
    <head>
        <title>
            Graph big number files
        </title>

        <link ref="stylesheet" href="css/layout.css"/>

        <script src="js/d3.min.js">
        </script>

        <script src="js/d3_handle.js"></script>
        <script src="js/Application.js"></script>
        <script src="js/ElementQueries.js"></script>
        <script src="js/ResizeSensor.js"></script>





        <style>

            body {
                font: 10px sans-serif;
            }

            .axis path,
            .axis line {
                fill: none;
                stroke: #000;
                shape-rendering: crispEdges;
            }

            .x.axis path {
                display: none;
            }

            .line {
                fill: none;
                stroke: steelblue;
                stroke-width: 1.5px;
            }
            #container
            {
                width: 1200px;
                margin: auto;
            }

        </style>



    </head>

    <body>
        <div id="container">
            <div id="elems_menu">
                <ul>
                    <li>
                        <input type="text" value="ws://localhost:10888/" id="ws_host" />
                        <button id="ws_connect">Connect!</button>
                    </li>
                </ul>
                <ul style="float: right">
                    <li>
                        Level: <input type="number" value="0" id="level"> Tile: <input type="number" value="0" id="index">
                    </li>
                    <li >
                        <button id="gotopos"> <strong>GO!</strong> </button>
                    </li>
                </ul>
                <ul style="float:left">
                    <li>
                        <button id="moveLeft">&lt;&lt;</button>
                        <button id="moveRight">&gt;&gt;</button>
                    </li>
                </ul>

            </div>

            <div id="graph_container" style="width: 100%; height: 600px;">

            </div>

        </div>



        <script>

            var main = function() {

                var graph_container = "#graph_container";
                var drawer = new D3_handle(graph_container);
                var host = "ws://localhost:10888/";
                var manager = null;


                d3.select("#moveRight").on("click", function()
                {
                    if(!manager) return;
                    manager.moveTile(+1);
                });
                d3.select("#moveLeft").on("click", function()
                {
                    if(!manager) return;
                    manager.moveTile(-1);
                });

                d3.select("#ws_connect").on("click", function()
                {
                    host = document.getElementById("ws_host").value;
                    manager = new ApplicationManager(host, drawer);

                });
                d3.select("#gotopos").on("click", function()
                {
                    var level = document.getElementById("level").value;
                    var index = document.getElementById("index").value;
                    if(manager == null) return;
                    manager.moveTo(level, index);
                });

                var main_node = d3.select(graph_container).node();
                main_node.onresize = function() {
                    console.log("Resize event called!");
                    drawer.reload();
                    if(manager)
                        manager.moveTile(0);
                };





                document.onkeydown =  function checkKey(e) {

                    e = e || window.event;

                    if(e.altKey)
                    {
                        if(e.keyCode == 67)
                        {
                            host = document.getElementById("ws_host").value;
                            manager = new ApplicationManager(host, drawer);
                        }
                    }

                    if (e.keyCode == '38') {
                        // up arrow
                        if(!manager) return;
                        manager.moveTile(1);
                    }
                    else if (e.keyCode == '40') {
                        // down arrow
                        if(!manager) return;
                        manager.moveTile(-1);
                    }
                    else if (e.keyCode == '37') {
                        // left arrow
                        if(!manager) return;
                        manager.moveTile(-1);
                    }
                    else if (e.keyCode == '39') {
                        // right arrow
                        if(!manager) return;
                        manager.moveTile(1);
                    }

                }

            };


            main();





        </script>


    </body>




</html>